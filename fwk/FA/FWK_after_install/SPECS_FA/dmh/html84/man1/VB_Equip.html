<HTML><HEAD>
<A NAME="VB_equip"></A>
<TITLE>Visual Basic GEM Equipment Application</TITLE></HEAD>
<BODY>
<HR>
<P>
<H2>NAME</H2>
 Visual Basic GEM Equipment Application
<HR>
<P>
<H2>SYNOPSIS</H2>
<P>
 <B>GemEquip.exe</B> 
<P>

<HR>
<P>
<H2>DESCRIPTION</H2>
<P>
Hume Integration provides Visual Basic source code and
project files to create a GEM Equipment simulator application
as part of its Application Development Package.
This VB application software is a prototype or demonstration of the 
techniques that are used to combine the Hume 
GEM software which is based on Tcl/Tk, with User Interface 
and Equipment control logic that executes in a separate process
or in separate processes.  
The VB application software is intended for Visual Basic 
version 6 on the Windows XP, 2000, or NT operating systems.
The techniques used in this example 
could also be used from C++, Java, or a programming environment 
on a non-Windows platform. 
<P>
When the VB application is executed, it starts
a dmh_wish process running in the background.  The dmh_wish
process acts as the server of a DMH message group, and
it also executes SECS/GEM equipment logic.  The VB application
uses DMH messages to control and integrate with the dmh_wish
process.  When the VB application is terminating, it also
terminates the background dmh_wish process.  If the VB application
is terminated abruptly, the dmh_wish process terminates when
it sees that the DMH communication is broken.  
The casual user is not aware that the apparent functionality is provided by
the coordinated teamwork of the two applications, since he is 
never involved in the startup, shutdown, or cleanup of the background
process.
<P>
<H2>INSTALLATION</H2>
The VB Application is distributed in a separate .zip archive file,
VB_Equip.zip.  If you received the DMH software on CDROM, 
the VB_Equip.zip archive is found in the subdirectory LAN_IMAGE. 
You will also need to install the DMH.ocx Active-X control from
the archive file DMHocx.zip which is found
in the same directory.
(See <A href="../indexes/DMHocx.html#Installation">DMHocx installation.</A>)
The distribution archive needs to be unzipped into a path
of your choosing; for example, c:\hume. 
The archive includes the subdirectory VB_Equip.  All of the source
and project files are found in this subdirectory.  The source files
include:
<dl>
<dt>DlgAlarmEdit.frm
<dd>A VB form for editing alarm definitions.
<dt>EquipUI.frm
<dd>The main form together with the application logic.
<dt>GemEquip.exe
<dd>A compiled executeable.  VB6 runtime components need to be
installed to use this.
<dt>GemEquip.vbp
<dd>The Visual Basic project file.  This is the file to open in 
the Visual Basic Studio.
<dt>EquipUI.frx
<dd>Data that is used by VB to create and initialize the EquipUI form.
</dl>

<h2>USAGE</H2>
The target audience of this software is a VB developer.  The expectation
is that the developer will load the software into the Visual Studio
environment and examine the well-commented source code.  The User Interface 
provided by the VB application is nearly identical to that provided by
the <A href="../man1/gem.html#Gemsim UI">gemsim</a> Tcl application.
However, a key difference is a set of buttons that will bring up
diagnostic and development windows connected to the dmh_wish
process.  
<P>
To develop a GEM interface for real equipment, the developer
should copy or mimic the logic found in the main form into his
own application.  The diagnostic and debugging capabilities can be
made accessible behind a password protected system menu.
As an alternative, it is possible to run separate utility 
programs when diagnostics are desired.  With the background process
performing as a DMH server, it is possible to connect to the
process from anywhere in the network.

<P>
<H2>SEE ALSO</H2>
<dl>
<dt><a href="../man1/gem.html">GEM EI Applications</A>
<dd>The VB application uses the gemsim application that is 
usually installed in /usr/local/gem/equip/, and described in this document.
<dt><a href="../../gem/equip/gemsim_server.bat">gemsim_server.bat </A>
<dd>
This batch file starts dmh_wish running as a background SECS process for
use by external software.  The dmh_wish startup imbedded in the
VB application is nearly equivalent.  The batch file contains documentation 
on the use of the DMH message system by the SECS/GEM logic.
<dt>
  <a href="../mann/secsport.html">secsport, hsms Tcl commands</A>
<dd>The applications leverage the secsport and hsms commands
that have been added to the extended Tcl interpreter.
<dt>
  <a href="../mann/TSN.html">Tcl SECS notation</A>
<dd>
The software manipulates SECS data structures using Tcl SECS notation.
<dt>
  <a href="../indexes/DMHocx.html">DMH.ocx Active-X Control</A>
<dd>The VB application uses an instance of the DMH.ocx Active-X control
to integrate with the DMH message system using native VB events,
method calls, and properties.
<dt>
  <a href="../mann/mbx.html">Distributed Message Hub (DMH)</A>
<dd>This is the reference information on the DMH message system
and its native Tcl API.
</dl>

<H2>AUTHOR</H2>
Hume Integration Software. <br>
This is licensed and supported software, (C)Copyright
2000 All Rights Reserved. 
<H2>KEYWORDS</H2>
GEM SECS VB Equipment DMH Hume
</BODY>
</HTML>
