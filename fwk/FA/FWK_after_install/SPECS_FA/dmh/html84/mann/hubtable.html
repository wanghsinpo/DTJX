<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<HTML><HEAD>
<TITLE>hubtable Dmhwidget</TITLE></HEAD>
<BODY>
<HR>
<P>
<H2>NAME</H2>
 hubtable - A Dmhwidget for displaying table data <P>
<H2>SYNOPSIS</H2>
  <B>dmhwidgets::hubtable<I> pathName </B></I>?<I>options</I>? <P>
<H2>INHERITANCE</H2>
 itk::Widget &lt;- iwidgets::Labeledwidget &lt;- iwidgets::Scrolledwidget &lt;-
 iwidgets::Scrolledlistbox &lt;- dmhwidgets::Hubtable
<P>
<H2>STANDARD OPTIONS</H2>
 <P>
<B>activebackground background borderwidth cursor exportselection
foreground highlightcolor highlightthickness relief selectbackground
selectborderwidth selectforeground
</B>	
<P>
See the <a href="../mann/options.html">options</a> manual entry for details on the standard options. <P>
<H2>INHERITED OPTIONS</H2>
 <P>
<B>activerelief dblclickcommand 
disabledforeground elementborderwidth height hscrollmode jump 
labelbitmap labelfont labelimage labelmargin labelpos
labeltext labelvariable sbwidth scrollmargin selectioncommand
selectmode state textbackground textfont troughcolor
visibleitems vscrollmode width
</B>
<P>
See the <a href="../mann/scrolledlistbox.html">scrolledlistbox</a> manual entry. <P>

<H2>WIDGET-SPECIFIC OPTIONS</H2>
 <P>
 <P>
Name:	<B>datacmd</B>&nbsp;
Class:	<B>Datacmd</B>&nbsp;
Command-Line Switch: <B>-datacmd</B> 
<DD>The <B>-datacmd</B> option is used to specify Tcl code to be 
evaluated to obtain the table data to be displayed.  The Tcl code
should be an SQL selection statement or any command that returns
table data in the <A href="../man1/datahub.html#TclReplyFormat">Tcl reply format</A>.
For example, <PRE>-datacmd {SQL {select * from dc_runrule}}</PRE>
The <B>hubtable</B> is designed to be used with either the <B>-datacmd</B> 
option specified, or the <B>-subscription</B> option specified.  The
 <B>-datacmd</B> option is used when the displayed data is to be
static or manually refreshed.  Typically when using the <B>-datacmd</B> 
option, the bind command is used to have &lt;F5&gt; invoke <I>pathName</I> <B>refresh</B>.
<P>
 <P>
Name:	<B>rhs_cols</B>&nbsp;
Class:	<B>Rhs_cols</B>&nbsp;
Command-Line Switch: <B>-rhs_cols</B> 
<DD>The <B>-rhs_cols</B> option is used to specify a list of column indexes
for which the data should be right-justified when padding with spaces for
alignment.  The default alignment for column data is the lefthand side.
When displaying numeric data, it is often desirable to align the data on
the right so that decimals and digit places are aligned.
<P>
Name:	<B>sortkeys</B>&nbsp;
Class:	<B>Sortkeys</B>&nbsp;
Command-Line Switch: <B>-sortkeys</B>&nbsp;
<DD>If the <B>-sortkey</B> option is not used, default sorting applies.
The default sorting when the <B>-subscription</B> option is used, is to
determine the data types of the key columns, and properly
sort character and numeric data in the key order of table.
The default sorting when the <B>-datacmd</B> is used, is to
display the data with the original order preserved.  The original
order may not be to your liking if you are using an SQL query 
that selects numeric columns because the SQL command orders data
using string comparisons.  You are able to specify the desired sorting
order using the <B>-sortkeys</B> option.  The syntax of the
<B>-sortkeys</B> value is:
<PRE>
[<I>index type</I>]+ [{<b>ascending</b> | <b>descending</b>}]
</PRE>
where <i>index</i> is the list element index into the data row(s),
and <i>type</i> is one of the literal terms <b>ascii</b>, <b>int</b>, or <b>real</b> 
to indicate what kind of data comparison is appropriate.  For example:
<PRE>
<I>pathName</I> configure -sortkeys {{2 real} {0 ascii} {1 ascii} ascending}
</PRE>
<P>
Warning - if you redefine the sorting, and you are using -subscription
the subscription notifications may not work correctly unless 
all of the table keys are included in the sort.
<P>
Name:	<B>subscription</B>&nbsp;
Class:	<B>Subscription</B>&nbsp;
Command-Line Switch: <B>-subscription</B>&nbsp;
<DD>The <B>-subscription</B> option is used to configure an in-memory
SQL table as the source of the displayed data.  The data display is
then kept current with the data in the table using a data subscription.
This option is used as an alternative to the <B>-datacmd</B> option.
The syntax of the <B>-subscription</B> value is:
<PRE>
<i>table</i> [<i>column_list</i> [<i>where_clause</i>]]
</PRE>
where <i>column_list</i> is an optional list of column names, and
<i>where_clause</i> is an optional clause to specify a selection
condition.  If the <i>where_clause</i> is specified, it should start
with the SQL keyword <b>where</B> and include the boolean 
conditions that normally follow the <b>where</b> keyword in an SQL
selection statement.  For example:
<PRE>
<I>pathName</I> configure -subscription {dc_item_use * {where spc_alarm&lt;&gt;0}}
</PRE>
<P>
<P>
<H2>DESCRIPTION</H2>
 <P>
The <B>hubtable</B> command creates a widget that displays table data,
and a new Tcl command whose name is <I>pathname</I>.  The command
is then used to invoke various methods of the widget.  The command has
the general form:<P>

<P>
<I>pathName option ?arg arg ... arg?</I>
<P>
<P>
One of the <B>-datacmd</B> or <B>-subscription</B> options is used to
specify the data to be displayed.  If you use the -datacmd, you may want 
to bind &lt;F5&gt; to the refresh action.
<P>
The -width and -height options are in terms of overall pixels.  You 
probably want to use <b>-visibleitems</b> to specify a <i>Columns</i><b>x</b><i>Rows</i>
value used to set the size of the table display.  
<P>
You should only specify a fixed pitch font for the data.
<P>

<H2>WIDGET-SPECIFIC METHODS</H2>
 
<DT><B><I>pathName</I> bindtag</B>
<DD>This method is a simplified means of getting the data listbox 
tag which is needed to add bindings for right-click actions.  For example, 
<PRE>
bind [$hubtab bindtag] &lt;Button-3&gt; "tk_popup $my_menu %X %Y"
</PRE>
<P>

<DT><B><I>pathName</I> reformat_data</B>
<DD>This method can be called when using the <B>-subscription</B> option.
It causes the spacing to be adjusted for the displayed data.  The method
is called internally to improve the displayed format if the
table is drawn before many data rows exist.  It can also be called by you.
<p>

<DT><B><I>pathName</I> refresh</B>
<DD>This method can be called when using the <B>-datacmd</B> option.
It causes the <b>-datacmd</b> code to be evaluated, and the displayed
data to be refreshed using the new query results.
<p>

<H2>EXAMPLE</H2>
 <PRE>

package require dmh
dmh_import
package require Dmhwidgets

SQL "create table dc_runrules (name varchar(10),description \
 varchar(80),primary key(name))"
SQL "insert into dc_runrules (name,description) values ('1sigma',\
 'Western Electric #3 - 4 of 5 points above +1 sigma or below -1 sigma')"
SQL "insert into dc_runrules (name,description) values ('1sigmaH',\
 '4 of 5 points higher than +1 sigma')"
SQL "insert into dc_runrules (name,description) values ('1sigmaL',\
 '4 of 5 points lower than -1 sigma')"
SQL "insert into dc_runrules (name,description) values ('2sigma',\
 'Western Electric #2 - 2 of 3 points above +2 sigma or below -2 sigma')"


dmhwidgets::hubtable .hubtable -subscription dc_runrules -visibleitems 40x10\
 -labelfont {Helvetica 12 bold} -labelpos nw -labeltext "Table dc_runrules"
pack .hubtable -side top -expand 1 -fill both
bind [.hubtable bindtag] &lt;Button-3&gt; "puts {rt-click action}"
</PRE>

<H2>AUTHOR</H2>
Hume Integration Software, www.hume.com

<H2>KEYWORDS  </H2>
SQL, datahub, table, widget
</BODY>
</HTML>
