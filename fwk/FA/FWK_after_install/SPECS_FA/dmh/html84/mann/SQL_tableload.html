<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<HTML><HEAD>
<TITLE>SQL_tableload Tcl Command</TITLE></HEAD>
<BODY>
<HR>
<P>
<H2>NAME</H2>
 SQL_tableload - copy from a persistent database to an in-memory table<BR>
<H2>SYNOPSIS</H2>
 <B>package require Humelib</B><BR>
 <B>humelib::SQL_tableload <I>sql_tablename</I> {<I>sql_cols</I> *} {<I>row_condition</I> {}} {<I>SQL_tablename</I> {}} {<I>SQL_cols</I> *} {<I>conn</I> sql}</B>

<HR>
<P>
<H2>DESCRIPTION</H2>
<P>
This command is used to copy table data from a persistent database to an in-memory table.
Optionally, a subset (selected columns/selected rows) of the data may be loaded.
Optionally, the column names or tablename may be different.
The column data types may be different but need to be compatible, such as DATE
and VARCHAR.  The in-memory table should already exist.
<P>
The command arguments are:
<DL>
<DT><I>sql_tablename</I>
<DD>The tablename in the persistent database.
<DT><I>sql_cols</I>
<DD>A list of column names in the persistent database table.  Defaults to all columns.
<DT><I>row_condition</I>
<DD>The selection expression of a where clause such as {username='bill' or username='bob'}
can be provided to specify which rows are to be copied.  The default is to copy all rows.
<DT><I>SQL_tablename</I>
<DD>The in-memory tablename.  Defaults to the same as the persistent database tablename.
<DT><I>SQL_cols</I>
<DD>The column names in the in-memory table in ordered correspondence to the <I>sql_cols</I> 
column list.  The default is to use the column names provided by the value of <I>sql_cols</I>,
or discovered from the schema of the persistent database table, if the value if <I>sql_cols</I>
is also <B>*</B>.
<DT><I>conn</I>
<DD>The name of the ODBC connection; defaults to <B>sql</B>.  The odbc connection should already exist before the command is used.
</DL>
<P>
An error is returned if a table or the ODBC connection does not exist.  The usual
return value is a two element list consisting of the number of rows queried from the
persistent database, and the number or rows successfully inserted into the in-memory
table.  The counts may be different if the in-memory table already has data with the
same key values.
<P>
The command logic uses the <a href="odbc.html">odbc <i>process_statement</i></a> command to reduce
the peak memory requirements needed to copy the table data.
<P>
The command is part of the <B>Humelib</B> package and it may be imported
from the <B>humelib</B> namespace.
<H2>EXAMPLE</H2>
<PRE>
package require Humelib
namespace import -force humelib::*
odbc connect sql MYDB scott tiger
# create in-memory table
SQL "create table dc_custom (domain varchar(32), name varchar(32), \
 description varchar(200), value varchar(2000), primary key(domain,name))"
# load from persistent database
set reply [SQL_tableload dc_custom]
puts "rows processed, rows inserted=$reply"
</PRE>
<H2>AUTHOR</H2>
 Hume Integration Software, www.hume.com  <P>
<H2>SEE ALSO</H2>
 <a href="../mann/odbc.html">odbc</A>&nbsp;
 <a href="../man1/datahub.html#INSERT">SQL insert</A>&nbsp;
<H2>KEYWORDS</H2>
 database, datahub, ODBC, SQL
</BODY>
</HTML>
