<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<HTML><HEAD>
<A NAME="mbx_RPC_cmds_"></A>
<TITLE>mbx_RPC Tcl Command</TITLE></HEAD>
<BODY>
<HR>
<P>
<H2>NAME</H2>
 mbx_RPC - Message command execution <P>
<H2>SYNOPSIS</H2>
 <B>dmh::mbx_RPC <I>?message ?reply_mailbox??</B></I> <P>
<HR>
<P>
<P>
<H2>DESCRIPTION</H2>
 <P>
This command is installed as part of the Distributed Message Hub from Hume Integration Software.  The command is used to execute received message commands as Tcl code, and send back reply messages.  The command also rearms the message system to handle the next message received on the same mailbox with the same handling code.  The reply message is always a two element list; the return code from evaluating the message as code, and the usual Tcl execution result or the <B>errorInfo</B> stack trace. <P>
If the arguments <B><I>message</B></I> and/or <B><I>reply_mailbox</B></I> are not supplied, their values are taken from the <b>::dmh</b> namespace variables <B>mbxmsg</B> and <B>mbxreply</B> respectively.  These variables are set up by the <B>mbx</B> command whenever a new message is received. <P>
The example: <PRE>
mbx whenmsg TCL_SERVER_RPC mbx_RPC
</PRE>
<P>
sets up the mailbox TCL_SERVER_RPC so that (1) whenever messages are sent to it,  they are executed as Tcl commands and (2) a reply message is sent out if the sender specified a reply mailbox.  The execution and reply message format are  described under the <B><a href="../mann/mh_eval.html">mh_eval</a></B> command. <P>
<P>
Here is an example to show how an application can utilize mbx_RPC functionality in another application.  <PRE>
proc mbx_send {mailbox args} {
    global MB_XACT TIMEOUT 
    set reply [lindex [mbx_do_xact $mailbox $args $MB_XACT $TIMEOUT] 0]
    if { $REPLY == "TIMEOUT" } { error "TIMEOUT on mbx_send with $mailbox" }
    vset $reply {rc result}
    if { $rc == "0" } { return $result }
    error $result
    }
<P>
</PRE>
In the above example, the <B>mbx_do_xact</B> command  dispatches events while waiting for a reply so the application stays responsive to the user interface or to other message exchanges if the reply is delayed.  The <B>mbx_do_xact</B> command and similar commands are described on the manpage <B><a href="../mann/mbx_cmds.html">mbx_cmds</a></B>. <P>
The functionality of the <B>mbx_RPC</B> command matches the expected behavior of the <a href="../man1/dmh_inspect.html">inspect</a> application which enables a remote Tcl Application to be inspected using the message system. <P>
<P>
<H2>SEE ALSO</H2>
 mbx, mbx_do_xact, mh_eval, send <P>
<H2>AUTHOR</H2>
 Ed Hume, Hume Integration Software <P>
<H2>KEYWORDS</H2>
 RPC, message system, dmh_inspect 
</BODY>
</HTML>
