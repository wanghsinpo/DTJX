<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<HTML><HEAD>
<TITLE>hub_safe_sub_set Tcl Command</TITLE></HEAD>
<BODY>
<HR>
<P>
<H2>NAME</H2>
 hub_safe_sub_set - close subscriptions when messages are not being read<P>
<H2>SYNOPSIS</H2>
 <B>package require Humelib</B><BR>
 <B>hub_safe_sub_set <I>mailbox max_message_count close_code</I> </B>
<HR>
<P>
<H2>DESCRIPTION</H2>
<P>
This command is executed in the DMH server process to periodically
check to see if unread DMH messages are accumulating in a mailbox
queue, and if so, to invoke user-provided cleanup code.  Use of this
command is highly recommended for subscription data feeds to user
interfaces and similar processes that may go away ungracefully.
<P>
The DMH server uses a global array with the name of <B>hub_safe_sub</B> to
manage the periodic checking.  This array can be inspected to diagnose
the status of the periodic checking.
<P>
The command is part of the <B>Humelib</B> package and it exists
in the global namespace.
<H2>EXAMPLE</H2>
<PRE>
package require Humelib

proc my_safe_client_open {sendto subname table {max_msgs 200}} {
   # use safe_open to monitor for lost subscriber
   set close_code "SQL {close sub $subname to $table}"
   eval $close_code
   SQL "open sub $subname to $table sendto=$sendto insert update delete *"
   hub_safe_sub_set $sendto $max_msgs $close_code
   }
</PRE>
<H2>AUTHOR</H2>
 Hume Integration Software, www.hume.com  <P>
<H2>SEE ALSO</H2>
 <a href="../mann/mbx.html">DMH</A>&nbsp;
 <a href="../man1/datahub.html#OPEN">SQL open</A>
<H2>KEYWORDS</H2>
 datahub, DMH, open, subscription
</BODY>
</HTML>
