<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<HTML><HEAD>
<A NAME="Tcl_CreateSlave_Tcl_7_6"></A>
<TITLE>Tcl_CreateSlave Tcl Library Procedures 7.6</TITLE></HEAD>
<BODY>
<HR>
<P>
<H2>NAME</H2>
 Tcl_IsSafe, Tcl_MakeSafe, Tcl_CreateSlave, Tcl_GetSlave, Tcl_GetMaster, Tcl_GetInterpPath, Tcl_CreateAlias, Tcl_CreateAliasObj, Tcl_GetAlias, Tcl_GetAliasObj, Tcl_ExposeCommand, Tcl_HideCommand - manage multiple Tcl interpreters, aliases and hidden commands. <P>
<H2>SYNOPSIS</H2>
 
<B>#include &lt;tcl.h&gt;</B>
<P>
int
<B>Tcl_IsSafe</B>(<I>interp</I>)
<P>
int
<B>Tcl_MakeSafe</B>(<I>interp</I>)
<P>
Tcl_Interp *
<B>Tcl_CreateSlave</B>(<I>interp, slaveName, isSafe</I>)
<P>
Tcl_Interp *
<B>Tcl_GetSlave</B>(<I>interp, slaveName</I>)
<P>
Tcl_Interp *
<B>Tcl_GetMaster</B>(<I>interp</I>)
<P>
int
<B>Tcl_GetInterpPath</B>(<I>askingInterp, slaveInterp</I>)
<P>
int
<B>Tcl_CreateAlias</B>(<I>slaveInterp, slaveCmd, targetInterp, targetCmd, argc, argv</I>)
<P>
int
<B>Tcl_CreateAliasObj</B>(<I>slaveInterp, slaveCmd, targetInterp, targetCmd, objc, objv</I>)
<P>
int
<B>Tcl_GetAlias</B>(<I>interp, slaveCmd, targetInterpPtr, targetCmdPtr, argcPtr, argvPtr</I>)
<P>
int
<B>Tcl_GetAliasObj</B>(<I>interp, slaveCmd, targetInterpPtr, targetCmdPtr, objcPtr, objvPtr</I>)
<P>
int
<B>Tcl_ExposeCommand</B>(<I>interp, hiddenCmdName, cmdName</I>)
<P>
int
<B>Tcl_HideCommand</B>(<I>interp, cmdName, hiddenCmdName</I>)
<P>
<H2>ARGUMENTS</H2>

<P><DT><B>Tcl_Interp <I>*interp</I></B> (in)
<DD>Interpreter in which to execute the specified command.
<P><DT><B>CONST char <I>*slaveName</I></B> (in)
<DD>Name of slave interpreter to create or manipulate.
<P><DT><B>int <I>isSafe</I></B> (in)
<DD>If non-zero, a ``safe'' slave that is suitable for running untrusted code
is created, otherwise a trusted slave is created.
<P><DT><B>Tcl_Interp <I>*slaveInterp</I></B> (in)
<DD>Interpreter to use for creating the source command for an alias (see
below).
<P><DT><B>CONST char <I>*slaveCmd</I></B> (in)
<DD>Name of source command for alias.
<P><DT><B>Tcl_Interp <I>*targetInterp</I></B> (in)
<DD>Interpreter that contains the target command for an alias.
<P><DT><B>CONST char <I>*targetCmd</I></B> (in)
<DD>Name of target command for alias in <I>targetInterp</I>.
<P><DT><B>int <I>argc</I></B> (in)
<DD>Count of additional arguments to pass to the alias command.
<P><DT><B>CONST char * CONST <I>*argv</I></B> (in)
<DD>Vector of strings, the additional arguments to pass to the alias command.
This storage is owned by the caller.
<P><DT><B>int <I>objc</I></B> (in)
<DD>Count of additional object arguments to pass to the alias object command.
<P><DT><B>Tcl_Object <I>**objv</I></B> (in)
<DD>Vector of Tcl_Obj structures, the additional object arguments to pass to
the alias object command.
This storage is owned by the caller.
<P><DT><B>Tcl_Interp <I>**targetInterpPtr</I></B> (in)
<DD>Pointer to location to store the address of the interpreter where a target
command is defined for an alias.
<P><DT><B>CONST char <I>**targetCmdPtr</I></B> (out)
<DD>Pointer to location to store the address of the name of the target command
for an alias.
<P><DT><B>int <I>*argcPtr</I></B> (out)
<DD>Pointer to location to store count of additional arguments to be passed to
the alias. The location is in storage owned by the caller.
<P><DT><B>CONST char <I>***argvPtr</I></B> (out)
<DD>Pointer to location to store a vector of strings, the additional arguments
to pass to an alias. The location is in storage owned by the caller, the
vector of strings is owned by the called function.
<P><DT><B>int <I>*objcPtr</I></B> (out)
<DD>Pointer to location to store count of additional object arguments to be
passed to the alias. The location is in storage owned by the caller.
<P><DT><B>Tcl_Obj <I>***objvPtr</I></B> (out)
<DD>Pointer to location to store a vector of Tcl_Obj structures, the additional
arguments to pass to an object alias command. The location is in storage
owned by the caller, the vector of Tcl_Obj structures is owned by the
called function.
<P><DT><B>CONST char <I>*cmdName</I></B> (in)
<DD>Name of an exposed command to hide or create.
<P><DT><B>CONST char <I>*hiddenCmdName</I></B> (in)
<DD>Name under which a hidden command is stored and with which it can be
exposed or invoked.
<HR>
<P>
<P>
<H2>DESCRIPTION</H2>

<P>
These procedures are intended for access to the multiple interpreter
facility from inside C programs. They enable managing multiple interpreters
in a hierarchical relationship, and the management of aliases, commands
that when invoked in one interpreter execute a command in another
interpreter. The return value for those procedures that return an <B>int</B>
is either <B>TCL_OK</B> or <B>TCL_ERROR</B>. If <B>TCL_ERROR</B> is returned
then the <B>result</B> field of the interpreter contains an error message.
<P>
<B>Tcl_CreateSlave</B> creates a new interpreter as a slave of <I>interp</I>.
It also creates a slave command named <I>slaveName</I> in <I>interp</I> which 
allows <I>interp</I> to manipulate the new slave. 
If <I>isSafe</I> is zero, the command creates a trusted slave in which Tcl
code has access to all the Tcl commands.
If it is <B>1</B>, the command creates a ``safe'' slave in which Tcl code
has access only to set of Tcl commands defined as ``Safe Tcl''; see the
manual entry for the Tcl <B>interp</B> command for details.
If the creation of the new slave interpreter failed, <B>NULL</B> is returned.
<P>
<B>Tcl_IsSafe</B> returns <B>1</B> if <I>interp</I> is ``safe'' (was created
with the <B>TCL_SAFE_INTERPRETER</B> flag specified),
<B>0</B> otherwise.
<P>
<B>Tcl_MakeSafe</B> marks <I>interp</I> as ``safe'', so that future
calls to <B>Tcl_IsSafe</B> will return 1.  It also removes all known
potentially-unsafe core functionality (both commands and variables)
from <I>interp</I>.  However, it cannot know what parts of an extension
or application are safe and does not make any attempt to remove those
parts, so safety is not guaranteed after calling <B>Tcl_MakeSafe</B>.
Callers will want to take care with their use of <B>Tcl_MakeSafe</B>
to avoid false claims of safety.  For many situations, <B>Tcl_CreateSlave</B>
may be a better choice, since it creates interpreters in a known-safe state.
<P>
<B>Tcl_GetSlave</B> returns a pointer to a slave interpreter of
<I>interp</I>. The slave interpreter is identified by <I>slaveName</I>.
If no such slave interpreter exists, <B>NULL</B> is returned.
<P>
<B>Tcl_GetMaster</B> returns a pointer to the master interpreter of
<I>interp</I>. If <I>interp</I> has no master (it is a
top-level interpreter) then <B>NULL</B> is returned.
<P>
<B>Tcl_GetInterpPath</B> sets the <I>result</I> field in <I>askingInterp</I>
to the relative path between <I>askingInterp</I> and <I>slaveInterp</I>;
<I>slaveInterp</I> must be a slave of <I>askingInterp</I>. If the computation
of the relative path succeeds, <B>TCL_OK</B> is returned, else
<B>TCL_ERROR</B> is returned and the <I>result</I> field in
<I>askingInterp</I> contains the error message.
<P>
<B>Tcl_CreateAlias</B> creates an object command named <I>slaveCmd</I> in
<I>slaveInterp</I> that when invoked, will cause the command <I>targetCmd</I>
to be invoked in <I>targetInterp</I>. The arguments specified by the strings
contained in <I>argv</I> are always prepended to any arguments supplied in the
invocation of <I>slaveCmd</I> and passed to <I>targetCmd</I>.
This operation returns <B>TCL_OK</B> if it succeeds, or <B>TCL_ERROR</B> if
it fails; in that case, an error message is left in the object result
of <I>slaveInterp</I>.
Note that there are no restrictions on the ancestry relationship (as
created by <B>Tcl_CreateSlave</B>) between <I>slaveInterp</I> and
<I>targetInterp</I>. Any two interpreters can be used, without any
restrictions on how they are related.
<P>
<B>Tcl_CreateAliasObj</B> is similar to <B>Tcl_CreateAlias</B> except 
that it takes a vector of objects to pass as additional arguments instead
of a vector of strings.
<P>
<B>Tcl_GetAlias</B> returns information about an alias <I>aliasName</I>
in <I>interp</I>. Any of the result fields can be <B>NULL</B>, in
which case the corresponding datum is not returned. If a result field is
non-<B>NULL</B>, the address indicated is set to the corresponding datum.
For example, if <I>targetNamePtr</I> is non-<B>NULL</B> it is set to a
pointer to the string containing the name of the target command.
<P>
<B>Tcl_GetAliasObj</B> is similar to <B>Tcl_GetAlias</B> except that it
returns a pointer to a vector of Tcl_Obj structures instead of a vector of
strings.
<P>
<B>Tcl_ExposeCommand</B> moves the command named <I>hiddenCmdName</I> from
the set of hidden commands to the set of exposed commands, putting
it under the name
<I>cmdName</I>. 
<I>HiddenCmdName</I> must be the name of an existing hidden
command, or the operation will return <B>TCL_ERROR</B> and leave an error
message in the <I>result</I> field in <I>interp</I>.
If an exposed command named <I>cmdName</I> already exists,
the operation returns <B>TCL_ERROR</B> and leaves an error message in the
object result of <I>interp</I>.
If the operation succeeds, it returns <B>TCL_OK</B>.
After executing this command, attempts to use <I>cmdName</I> in a call to
<B>Tcl_Eval</B> or with the Tcl <B>eval</B> command will again succeed.
<P>
<B>Tcl_HideCommand</B> moves the command named <I>cmdName</I> from the set of
exposed commands to the set of hidden commands, under the name
<I>hiddenCmdName</I>.
<I>CmdName</I> must be the name of an existing exposed
command, or the operation will return <B>TCL_ERROR</B> and leave an error
message in the object result of <I>interp</I>.
Currently both <I>cmdName</I> and <I>hiddenCmdName</I> must not contain
namespace qualifiers, or the operation will return <B>TCL_ERROR</B> and
leave an error message in the object result of <I>interp</I>.
The <I>CmdName</I> will be looked up in the global namespace, and not
relative to the current namespace, even if the current namespace is not the
global one.
If a hidden command whose name is <I>hiddenCmdName</I> already
exists, the operation also returns <B>TCL_ERROR</B> and the <I>result</I>
field in <I>interp</I> contains an error message.
If the operation succeeds, it returns <B>TCL_OK</B>.
After executing this command, attempts to use <I>cmdName</I> in a call to
<B>Tcl_Eval</B> or with the Tcl <B>eval</B> command will fail.
<P>
For a description of the Tcl interface to multiple interpreters, see
<I><a href="../mann/interp.html">interp</a></I>.
<P>
<H2>SEE ALSO</H2>

interp
<P>
<P>
<H2>KEYWORDS</H2>

alias, command, exposed commands, hidden commands, interpreter, invoke,
master, slave

</BODY>
</HTML>
