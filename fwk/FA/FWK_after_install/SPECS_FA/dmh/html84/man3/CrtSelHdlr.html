<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<HTML><HEAD>
<A NAME="Tk_CreateSelHandler_Tk_4_0"></A>
<TITLE>Tk_CreateSelHandler Tk Library Procedures 4.0</TITLE></HEAD>
<BODY>
<HR>
<P>
<H2>NAME</H2>
 Tk_CreateSelHandler, Tk_DeleteSelHandler - arrange to handle requests for a selection <P>
<H2>SYNOPSIS</H2>
 
<B>#include &lt;tk.h&gt;</B>
<P>
<B>Tk_CreateSelHandler</B>(<I>tkwin, selection, target, proc, clientData, format</I>)
<P>
<B>Tk_DeleteSelHandler</B>(<I>tkwin, selection, target</I>)
<P>
<H2>ARGUMENTS</H2>

<P><DT><B>Tk_Window <I>tkwin</I></B> (in)
<DD>Window for which <I>proc</I> will provide selection information.
<P><DT><B>Atom <I>selection</I></B> (in)
<DD>The name of the selection for which <I>proc</I> will provide
selection information.
<P><DT><B>Atom <I>target</I></B> (in)
<DD>Form in which <I>proc</I> can provide the selection (e.g. STRING
or FILE_NAME).  Corresponds to <I>type</I> arguments in <B>selection</B>
commands.
<P><DT><B>Tk_SelectionProc <I>*proc</I></B> (in)
<DD>Procedure to invoke whenever the selection is owned by <I>tkwin</I>
and the selection contents are requested in the format given by
<I>target</I>.
<P><DT><B>ClientData <I>clientData</I></B> (in)
<DD>Arbitrary one-word value to pass to <I>proc</I>.
<P><DT><B>Atom <I>format</I></B> (in)
<DD>If the selection requestor isn't in this process, <I>format</I> determines
the representation used to transmit the selection to its
requestor.
<HR>
<P>
<P>
<H2>DESCRIPTION</H2>

<P>
<B>Tk_CreateSelHandler</B> arranges for a particular procedure
(<I>proc</I>) to be called whenever <I>selection</I> is owned by
<I>tkwin</I> and the selection contents are requested in the
form given by <I>target</I>. 
<I>Target</I> should be one of
the entries defined in the left column of Table 2 of the
X Inter-Client Communication Conventions Manual (ICCCM) or
any other form in which an application is willing to present
the selection.  The most common form is STRING.
<P>
<I>Proc</I> should have arguments and result that match the
type <B>Tk_SelectionProc</B>:
<PRE>
typedef int Tk_SelectionProc(
	ClientData <I>clientData</I>,
	int <I>offset</I>,
	char *<I>buffer</I>,
	int <I>maxBytes</I>);
</PRE>
The <I>clientData</I> parameter to <I>proc</I> is a copy of the <I>clientData</I> argument given to <B>Tk_CreateSelHandler</B>. Typically, <I>clientData</I> points to a data structure containing application-specific information that is needed to retrieve the selection.  <I>Offset</I> specifies an offset position into the selection, <I>buffer</I> specifies a location at which to copy information about the selection, and <I>maxBytes</I> specifies the amount of space available at <I>buffer</I>.  <I>Proc</I> should place a NULL-terminated string at <I>buffer</I> containing <I>maxBytes</I> or fewer characters (not including the terminating NULL), and it should return a count of the number of non-NULL characters stored at <I>buffer</I>.  If the selection no longer exists (e.g. it once existed but the user deleted the range of characters containing it), then <I>proc</I> should return -1. <P>
When transferring large selections, Tk will break them up into smaller pieces (typically a few thousand bytes each) for more efficient transmission.  It will do this by calling <I>proc</I> one or more times, using successively higher values of <I>offset</I> to retrieve successive portions of the selection.  If <I>proc</I> returns a count less than <I>maxBytes</I> it means that the entire remainder of the selection has been returned.  If <I>proc</I>'s return value is <I>maxBytes</I> it means there may be additional information in the selection, so Tk must make another call to <I>proc</I> to retrieve the next portion. <P>
<I>Proc</I> always returns selection information in the form of a character string.  However, the ICCCM allows for information to be transmitted from the selection owner to the selection requestor in any of several formats, such as a string, an array of atoms, an array of integers, etc.  The <I>format</I> argument to <B>Tk_CreateSelHandler</B> indicates what format should be used to transmit the selection to its requestor (see the middle column of Table 2 of the ICCCM for examples).  If <I>format</I> is not STRING, then Tk will take the value returned by <I>proc</I> and divided it into fields separated by white space.  If <I>format</I> is ATOM, then Tk will return the selection as an array of atoms, with each field in <I>proc</I>'s result treated as the name of one atom.  For any other value of <I>format</I>, Tk will return the selection as an array of 32-bit values where each field of <I>proc</I>'s result is treated as a number and translated to a 32-bit value.  In any event, the <I>format</I> atom is returned to the selection requestor along with the contents of the selection. <P>
If <B>Tk_CreateSelHandler</B> is called when there already exists a handler for <I>selection</I> and <I>target</I> on <I>tkwin</I>, then the existing handler is replaced with a new one. <P>
<B>Tk_DeleteSelHandler</B> removes the handler given by <I>tkwin</I>, <I>selection</I>, and <I>target</I>, if such a handler exists. If there is no such handler then it has no effect. <P>
<P>
<H2>KEYWORDS</H2>
 format, handler, selection, target 
</BODY>
</HTML>
